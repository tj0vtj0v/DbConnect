import mysql.connector as db


class Connector:
    def __init__(self, user: str, password: str, database: str, host: str = "raspi", port: str = "3306"):
        self.database = db.connect(
            host=host,
            port=port,
            user=user,
            password=password,
            database=database
        )

        self.database.autocommit = True
        self.actor = self.database.cursor()

    def make_entry(self, table, values):
        self.actor.execute(f"""INSERT INTO `{table}` VALUES ({values});""")
        self.database.commit()

    def delete_entries_before_timestamp(self, table, min_time):
        self.actor.execute(f"""DELETE FROM `{table}` WHERE `timestamp` < '{min_time}';""")
        self.database.commit()

    def close_connection(self):
        self.actor.close()
        self.database.close()
